{{ if .Params.slides }}
<div class="slideshow-container">
  <div class="slideshow">
    {{ range $index, $slide := .Params.slides }}
    {{ $image := $.Page.Resources.GetMatch $slide.image }}
    {{ $imageWebP := $image.Process "webp" }}
    {{ $imageMobileWebP := $image.Resize "700x webp" }}
    
    <div class="slide {{ if eq $index 0 }}active{{ else }}inactive{{ end }}" data-index="{{ $index }}">
      <div class="slide-content">
        <picture>
          <!-- WebP versions -->
          <source 
            srcset="{{ $imageMobileWebP.RelPermalink }} 700w, {{ $imageWebP.RelPermalink }} 1200w"
            sizes="(max-width: 768px) 100vw, 100vw"
            type="image/webp">
          <!-- Fallback for browsers that don't support WebP -->
          <img src="{{ $image.RelPermalink }}" 
               alt="{{ $slide.caption }}" 
               class="slide-image"
               loading="lazy">
        </picture>
      </div>
    </div>
    {{ end }}
    
    <div class="slide-footer">
      <div class="slide-count">
        <span id="current-slide">1</span> / <span id="total-slides">{{ len .Params.slides }}</span>
      </div>
      
      {{ range $index, $slide := .Params.slides }}
      <div class="caption {{ if eq $index 0 }}active{{ else }}inactive{{ end }}">
        {{ $slide.caption }}
      </div>
      {{ end }}
    </div>
    
    <button class="slide-nav prev" aria-label="Previous slide">&lt;</button>
    <button class="slide-nav next" aria-label="Next slide">&gt;</button>
  </div>
</div>
{{ end }}